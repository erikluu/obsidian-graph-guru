/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  ExampleModal: () => ExampleModal,
  GraphView: () => GraphView,
  VIEW_TYPE_GRAPH: () => VIEW_TYPE_GRAPH,
  default: () => GuruPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian = require("obsidian");
var import_child_process = require("child_process");
var GuruPlugin = class extends import_obsidian.Plugin {
  async onload() {
    const files = await this.getAllFiles();
    console.log(files);
    const preprocessedFiles = await this.sendToPythonScript(files);
    console.log(preprocessedFiles);
    this.registerView(
      VIEW_TYPE_GRAPH,
      (leaf) => new GraphView(leaf, files.length)
    );
    this.addRibbonIcon("citrus", "Activate Graph View", () => {
      console.log("lmao");
    });
    await this.loadSettings();
    this.addSettingTab(new GuruSettingTab(this.app, this));
    const statusBarItemEl = this.addStatusBarItem();
    statusBarItemEl.setText(`Graph Guru focused on ${files.length} files`);
  }
  onunload() {
    console.log("unloading plugin");
    this.app.workspace.detachLeavesOfType(VIEW_TYPE_GRAPH);
  }
  async activateView() {
    this.app.workspace.detachLeavesOfType(VIEW_TYPE_GRAPH);
    await this.app.workspace.getRightLeaf(false).setViewState({
      type: VIEW_TYPE_GRAPH,
      active: true
    });
    this.app.workspace.revealLeaf(
      this.app.workspace.getLeavesOfType(VIEW_TYPE_GRAPH)[0]
    );
  }
  async loadSettings() {
    this.settings = Object.assign({}, DEFAULT_SETTINGS, await this.loadData());
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
  // PREPROCESSING ------------------------------------------------
  async getAllFiles() {
    const files = this.app.vault.getFiles();
    const fileObjects = files.map(async (f) => {
      const text = await this.app.vault.read(f);
      const metadata = this.app.metadataCache.getFileCache(f);
      let tags = null;
      if (metadata != null) {
        tags = (0, import_obsidian.getAllTags)(metadata);
      }
      return {
        text,
        metadata,
        tags
      };
    });
    return fileObjects;
  }
  async sendToPythonScript(files) {
    return new Promise((resolve, reject) => {
      const pythonProcess = (0, import_child_process.spawn)("python", ["./preprocessing.py"]);
      const results = [];
      pythonProcess.stdout.on("data", (data) => {
        results.push(JSON.parse(data.toString()));
      });
      pythonProcess.stderr.on("data", (data) => {
        reject(data.toString());
      });
      pythonProcess.on("close", (code) => {
        if (code === 0) {
          resolve(results);
        } else {
          reject(`Python process exited with code ${code}`);
        }
      });
      for (const file of files) {
        pythonProcess.stdin.write(JSON.stringify(file) + "\n");
      }
      pythonProcess.stdin.end();
    });
  }
};
var VIEW_TYPE_GRAPH = "graph-view";
var GraphView = class extends import_obsidian.ItemView {
  constructor(leaf, numFiles) {
    super(leaf);
    this.numFiles = numFiles;
  }
  getViewType() {
    return VIEW_TYPE_GRAPH;
  }
  getDisplayText() {
    return "Graph View";
  }
  async onOpen() {
    const containerEl = this.containerEl.children[1];
    containerEl.empty();
    containerEl.createEl("h4", { text: `Number of Files Found: ${this.numFiles}` });
  }
  async onClose() {
  }
};
var ExampleModal = class extends import_obsidian.Modal {
  constructor(app, onSubmit) {
    super(app);
    this.onSubmit = onSubmit;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h1", { text: "What's your name?" });
    new import_obsidian.Setting(contentEl).setName("Name").addText((text) => text.onChange((value) => {
      this.result = value;
    }));
    new import_obsidian.Setting(contentEl).addButton((btn) => btn.setButtonText("Submit").setCta().onClick(() => {
      this.close();
      this.onSubmit(this.result);
    }));
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
var DEFAULT_SETTINGS = {
  focus_directory: "./",
  favorite_color: "Purple"
};
var GuruSettingTab = class extends import_obsidian.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Graph Guru Settings" });
    new import_obsidian.Setting(containerEl).setName("Focus Directory").setDesc("Enter the directory you wish for The Guru to focus on.").addText((text) => text.setPlaceholder("Enter your directory").setValue(this.plugin.settings.focus_directory).onChange(async (value) => {
      console.log("Directory: " + value);
      this.plugin.settings.focus_directory = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian.Setting(containerEl).setName("Favorite Color").setDesc("Let us know your favorite color.").addText((text) => text.setPlaceholder("Enter color").setValue(this.plugin.settings.favorite_color).onChange(async (value) => {
      console.log("Color: " + value);
      this.plugin.settings.favorite_color = value;
      await this.plugin.saveSettings();
    }));
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBJdGVtVmlldywgV29ya3NwYWNlTGVhZiwgTW9kYWwsIFBsdWdpbiwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZywgVEZpbGUsIENhY2hlZE1ldGFkYXRhLCBnZXRBbGxUYWdzIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgc3Bhd24gfSBmcm9tICdjaGlsZF9wcm9jZXNzJztcblxuLy8gJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJVxuLy8gUGx1Z2luIE1haW5cbi8vICUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSVcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR3VydVBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG4gICAgc2V0dGluZ3M6IEd1cnVTZXR0aW5ncztcblxuICAgIGFzeW5jIG9ubG9hZCgpIHtcbiAgICAgICAgY29uc3QgZmlsZXMgPSBhd2FpdCB0aGlzLmdldEFsbEZpbGVzKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGZpbGVzKVxuICAgICAgICBjb25zdCBwcmVwcm9jZXNzZWRGaWxlcyA9IGF3YWl0IHRoaXMuc2VuZFRvUHl0aG9uU2NyaXB0KGZpbGVzKTtcbiAgICAgICAgY29uc29sZS5sb2cocHJlcHJvY2Vzc2VkRmlsZXMpO1xuXG4gICAgICAgIC8vIHJlZ2lzdGVyIHZpZXdcbiAgICAgICAgdGhpcy5yZWdpc3RlclZpZXcoXG4gICAgICAgICAgICBWSUVXX1RZUEVfR1JBUEgsXG4gICAgICAgICAgICAobGVhZikgPT4gbmV3IEdyYXBoVmlldyhsZWFmLCBmaWxlcy5sZW5ndGgpXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gcmliYm9uIGJ1dHRvblxuICAgICAgICB0aGlzLmFkZFJpYmJvbkljb24oXCJjaXRydXNcIiwgXCJBY3RpdmF0ZSBHcmFwaCBWaWV3XCIsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwibG1hb1wiKVxuICAgICAgICB9KVxuXG4gICAgICAgIC8vIGxvYWQgc2V0dGluZ3NcbiAgICAgICAgYXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBHdXJ1U2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpXG5cbiAgICAgICAgLy8gVGhpcyBhZGRzIGEgc3RhdHVzIGJhciBpdGVtIHRvIHRoZSBib3R0b20gb2YgdGhlIGFwcC4gRG9lcyBub3Qgd29yayBvbiBtb2JpbGUgYXBwcy5cbiAgICAgICAgY29uc3Qgc3RhdHVzQmFySXRlbUVsID0gdGhpcy5hZGRTdGF0dXNCYXJJdGVtKCk7XG4gICAgICAgIHN0YXR1c0Jhckl0ZW1FbC5zZXRUZXh0KGBHcmFwaCBHdXJ1IGZvY3VzZWQgb24gJHtmaWxlcy5sZW5ndGh9IGZpbGVzYCk7XG4gICAgfVxuXG4gICAgb251bmxvYWQoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCd1bmxvYWRpbmcgcGx1Z2luJyk7XG4gICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5kZXRhY2hMZWF2ZXNPZlR5cGUoVklFV19UWVBFX0dSQVBIKTtcbiAgICB9XG5cbiAgICBhc3luYyBhY3RpdmF0ZVZpZXcoKSB7XG4gICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5kZXRhY2hMZWF2ZXNPZlR5cGUoVklFV19UWVBFX0dSQVBIKTtcblxuICAgICAgICBhd2FpdCB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0UmlnaHRMZWFmKGZhbHNlKS5zZXRWaWV3U3RhdGUoe1xuICAgICAgICAgICAgdHlwZTogVklFV19UWVBFX0dSQVBILFxuICAgICAgICAgICAgYWN0aXZlOiB0cnVlLFxuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFwcC53b3Jrc3BhY2UucmV2ZWFsTGVhZihcbiAgICAgICAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWF2ZXNPZlR5cGUoVklFV19UWVBFX0dSQVBIKVswXVxuICAgICAgICApO1xuICAgIH1cblxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGF3YWl0IHRoaXMubG9hZERhdGEoKSk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIC8vIFBSRVBST0NFU1NJTkcgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgYXN5bmMgZ2V0QWxsRmlsZXMoKSB7XG4gICAgICAgIGNvbnN0IGZpbGVzOiBURmlsZVtdID0gdGhpcy5hcHAudmF1bHQuZ2V0RmlsZXMoKTtcbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGZpbGVPYmplY3RzID0gZmlsZXMubWFwKGFzeW5jIChmKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB0ZXh0OiBzdHJpbmcgPSBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGYpO1xuICAgICAgICAgICAgY29uc3QgbWV0YWRhdGE6IENhY2hlZE1ldGFkYXRhIHwgbnVsbCA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGYpO1xuICAgICAgICAgICAgbGV0IHRhZ3M6IHN0cmluZ1tdIHwgbnVsbCA9IG51bGxcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKG1ldGFkYXRhICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgICB0YWdzID0gZ2V0QWxsVGFncyhtZXRhZGF0YSk7ICAgIFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHRleHQ6IHRleHQsXG4gICAgICAgICAgICAgICAgbWV0YWRhdGE6IG1ldGFkYXRhLFxuICAgICAgICAgICAgICAgIHRhZ3M6IHRhZ3NcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGZpbGVPYmplY3RzO1xuICAgIH1cblxuICAgIGFzeW5jIHNlbmRUb1B5dGhvblNjcmlwdChmaWxlczogb2JqZWN0W10pOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBweXRob25Qcm9jZXNzID0gc3Bhd24oJ3B5dGhvbicsIFsnLi9wcmVwcm9jZXNzaW5nLnB5J10pO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0czogc3RyaW5nW10gPSBbXTtcblxuICAgICAgICAgICAgcHl0aG9uUHJvY2Vzcy5zdGRvdXQub24oJ2RhdGEnLCAoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaChKU09OLnBhcnNlKGRhdGEudG9TdHJpbmcoKSkpOyAvLyBtYXliZSBub3QgdG9TdHJpbmdcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBweXRob25Qcm9jZXNzLnN0ZGVyci5vbignZGF0YScsIChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGRhdGEudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcHl0aG9uUHJvY2Vzcy5vbignY2xvc2UnLCAoY29kZSkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChjb2RlID09PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0cyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVqZWN0KGBQeXRob24gcHJvY2VzcyBleGl0ZWQgd2l0aCBjb2RlICR7Y29kZX1gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgZm9yIChjb25zdCBmaWxlIG9mIGZpbGVzKSB7XG4gICAgICAgICAgICAgICAgcHl0aG9uUHJvY2Vzcy5zdGRpbi53cml0ZShKU09OLnN0cmluZ2lmeShmaWxlKSArICdcXG4nKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcHl0aG9uUHJvY2Vzcy5zdGRpbi5lbmQoKTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuXG4vLyAlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlXG4vLyBWaWV3XG4vLyAlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlXG5cbmV4cG9ydCBjb25zdCBWSUVXX1RZUEVfR1JBUEggPSBcImdyYXBoLXZpZXdcIjtcblxuZXhwb3J0IGNsYXNzIEdyYXBoVmlldyBleHRlbmRzIEl0ZW1WaWV3IHtcbiAgICBudW1GaWxlczogbnVtYmVyO1xuXG4gICAgY29uc3RydWN0b3IobGVhZjogV29ya3NwYWNlTGVhZiwgbnVtRmlsZXM6IG51bWJlcikge1xuICAgICAgICBzdXBlcihsZWFmKTtcbiAgICAgICAgdGhpcy5udW1GaWxlcyA9IG51bUZpbGVzO1xuICAgIH1cblxuICAgIGdldFZpZXdUeXBlKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiBWSUVXX1RZUEVfR1JBUEg7XG4gICAgfVxuXG4gICAgZ2V0RGlzcGxheVRleHQoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIFwiR3JhcGggVmlld1wiXG4gICAgfVxuXG4gICAgYXN5bmMgb25PcGVuKCkge1xuICAgICAgICBjb25zdCBjb250YWluZXJFbCA9IHRoaXMuY29udGFpbmVyRWwuY2hpbGRyZW5bMV07XG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiaDRcIiwgeyB0ZXh0OiBgTnVtYmVyIG9mIEZpbGVzIEZvdW5kOiAke3RoaXMubnVtRmlsZXN9YH0pO1xuICAgIH1cblxuICAgIGFzeW5jIG9uQ2xvc2UoKSB7XG5cbiAgICB9XG59XG5cbi8vICUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSVcbi8vIE1vZGFsXG4vLyAlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlXG5cbmV4cG9ydCBjbGFzcyBFeGFtcGxlTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgcmVzdWx0OiBzdHJpbmc7XG4gICAgb25TdWJtaXQ6IChyZXN1bHQ6IHN0cmluZykgPT4gdm9pZDtcbiAgXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIG9uU3VibWl0OiAocmVzdWx0OiBzdHJpbmcpID0+IHZvaWQpIHtcbiAgICAgIHN1cGVyKGFwcCk7XG4gICAgICB0aGlzLm9uU3VibWl0ID0gb25TdWJtaXQ7XG4gICAgfVxuICBcbiAgICBvbk9wZW4oKSB7XG4gICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgXG4gICAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJoMVwiLCB7IHRleHQ6IFwiV2hhdCdzIHlvdXIgbmFtZT9cIiB9KTtcbiAgXG4gICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgIC5zZXROYW1lKFwiTmFtZVwiKVxuICAgICAgICAuYWRkVGV4dCgodGV4dCkgPT5cbiAgICAgICAgICB0ZXh0Lm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHQgPSB2YWx1ZVxuICAgICAgICAgIH0pKTtcbiAgXG4gICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgIC5hZGRCdXR0b24oKGJ0bikgPT5cbiAgICAgICAgICBidG5cbiAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiU3VibWl0XCIpXG4gICAgICAgICAgICAuc2V0Q3RhKClcbiAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICB0aGlzLm9uU3VibWl0KHRoaXMucmVzdWx0KTtcbiAgICAgICAgICAgIH0pKTtcbiAgICB9XG4gIFxuICAgIG9uQ2xvc2UoKSB7XG4gICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAgIGNvbnRlbnRFbC5lbXB0eSgpO1xuICAgIH1cbiAgfVxuXG4vLyAlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlXG4vLyBTZXR0aW5nc1xuLy8gJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJVxuXG5pbnRlcmZhY2UgR3VydVNldHRpbmdzIHtcbiAgICBmb2N1c19kaXJlY3Rvcnk6IHN0cmluZztcbiAgICBmYXZvcml0ZV9jb2xvcjogc3RyaW5nO1xufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBHdXJ1U2V0dGluZ3MgPSB7XG4gICAgZm9jdXNfZGlyZWN0b3J5OiAnLi8nLFxuICAgIGZhdm9yaXRlX2NvbG9yOiAnUHVycGxlJ1xufSBcblxuY2xhc3MgR3VydVNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBwbHVnaW46IEd1cnVQbHVnaW47XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBHdXJ1UGx1Z2luKSB7XG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgfVxuXG4gICAgZGlzcGxheSgpOiB2b2lkIHtcbiAgICAgICAgY29uc3Qge2NvbnRhaW5lckVsfSA9IHRoaXM7XG5cbiAgICAgICAgY29udGFpbmVyRWwuZW1wdHkoKTtcblxuICAgICAgICBjb250YWluZXJFbC5jcmVhdGVFbCgnaDInLCB7dGV4dDogJ0dyYXBoIEd1cnUgU2V0dGluZ3MnfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnRm9jdXMgRGlyZWN0b3J5JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdFbnRlciB0aGUgZGlyZWN0b3J5IHlvdSB3aXNoIGZvciBUaGUgR3VydSB0byBmb2N1cyBvbi4nKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdFbnRlciB5b3VyIGRpcmVjdG9yeScpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZvY3VzX2RpcmVjdG9yeSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdEaXJlY3Rvcnk6ICcgKyB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmZvY3VzX2RpcmVjdG9yeSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIFxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdGYXZvcml0ZSBDb2xvcicpXG4gICAgICAgICAgICAuc2V0RGVzYygnTGV0IHVzIGtub3cgeW91ciBmYXZvcml0ZSBjb2xvci4nKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdFbnRlciBjb2xvcicpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZhdm9yaXRlX2NvbG9yKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0NvbG9yOiAnICsgdmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5mYXZvcml0ZV9jb2xvciA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIFxuICAgIH1cbn1cbiJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSxzQkFBMEg7QUFDMUgsMkJBQXNCO0FBTXRCLElBQXFCLGFBQXJCLGNBQXdDLHVCQUFPO0FBQUEsRUFHM0MsTUFBTSxTQUFTO0FBQ1gsVUFBTSxRQUFRLE1BQU0sS0FBSyxZQUFZO0FBQ3JDLFlBQVEsSUFBSSxLQUFLO0FBQ2pCLFVBQU0sb0JBQW9CLE1BQU0sS0FBSyxtQkFBbUIsS0FBSztBQUM3RCxZQUFRLElBQUksaUJBQWlCO0FBRzdCLFNBQUs7QUFBQSxNQUNEO0FBQUEsTUFDQSxDQUFDLFNBQVMsSUFBSSxVQUFVLE1BQU0sTUFBTSxNQUFNO0FBQUEsSUFDOUM7QUFHQSxTQUFLLGNBQWMsVUFBVSx1QkFBdUIsTUFBTTtBQUN0RCxjQUFRLElBQUksTUFBTTtBQUFBLElBQ3RCLENBQUM7QUFHRCxVQUFNLEtBQUssYUFBYTtBQUN4QixTQUFLLGNBQWMsSUFBSSxlQUFlLEtBQUssS0FBSyxJQUFJLENBQUM7QUFHckQsVUFBTSxrQkFBa0IsS0FBSyxpQkFBaUI7QUFDOUMsb0JBQWdCLFFBQVEseUJBQXlCLE1BQU0sY0FBYztBQUFBLEVBQ3pFO0FBQUEsRUFFQSxXQUFX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
